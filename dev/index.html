<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · ProfileLikelihood.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://DanielVandH.github.io/ProfileLikelihood.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>ProfileLikelihood.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li><li><a class="tocitem" href="interface/">Interface</a></li><li><a class="tocitem" href="docstrings/">Docstrings</a></li><li><a class="tocitem" href="regression/">Example I: Multiple linear regression</a></li><li><a class="tocitem" href="logistic/">Example II: Logistic ordinary differential equation</a></li><li><a class="tocitem" href="exponential/">Example III: Linear exponential ODE and grid searching</a></li><li><a class="tocitem" href="lotka/">Example IV: Lotka-Volterra ODE and computing bivarate profile likelihoods</a></li><li><a class="tocitem" href="stefan/">Example V: Fisher-Stefan PDE</a></li><li><a class="tocitem" href="math/">Mathematical and Implementation Details</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DanielVandH/ProfileLikelihood.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ProfileLikelihood"><a class="docs-heading-anchor" href="#ProfileLikelihood">ProfileLikelihood</a><a id="ProfileLikelihood-1"></a><a class="docs-heading-anchor-permalink" href="#ProfileLikelihood" title="Permalink"></a></h1><p><a href="https://zenodo.org/badge/latestdoi/508701126"><img src="https://zenodo.org/badge/508701126.svg" alt="DOI"/></a></p><p>This package defines the routines required for computing maximum likelihood estimates and profile likelihoods. The optimisation routines are built around the <a href="https://github.com/SciML/Optimization.jl">Optimization.jl</a> interface, allowing us to e.g. easily switch between algorithms, between finite differences and automatic differentiation, and it allows for constraints to be defined with ease. Below we list the definitions we are using for likelihoods and profile likelihoods. This code only works for scalar or bivariate parameters of interest (i.e. out of a vector <span>$\boldsymbol \theta$</span>, you can profile a single scalar parameter <span>$\theta_i \in \boldsymbol\theta$</span> or a pair <span>$(\theta_i,\theta_j) \in \boldsymbol\theta$</span>) for now. We use the following definitions:</p><p><strong>Definition: Likelihood function</strong> (see Casella &amp; Berger, 2002): Let <span>$f(\boldsymbol x \mid \boldsymbol \theta)$</span> denote the joint probability density function (PDF) of the sample <span>$\boldsymbol X = (X_1,\ldots,X_n)^{\mathsf T}$</span>, where <span>$\boldsymbol \theta \in \Theta$</span> is some set of parameters and <span>$\Theta$</span> is the parameter space. We define the <em>likelihood function</em> <span>$\mathcal L \colon \Theta \to [0, \infty)$</span> by <span>$\mathcal L(\boldsymbol \theta \mid \boldsymbol x) = f(\boldsymbol x \mid \boldsymbol \theta)$</span> for some realisation <span>$\boldsymbol x = (x_1,\ldots,x_n)^{\mathsf T}$</span> of <span>$\boldsymbol X$</span>. The <em>log-likelihood function</em> <span>$\ell\colon\Theta\to\mathbb R$</span> is defined by <span>$\ell(\boldsymbol \theta \mid \boldsymbol x) =  \log\mathcal L(\boldsymbol\theta \mid \boldsymbol x)$</span>.The <em>maximum likelihood estimate</em> (MLE) <span>$\hat{\boldsymbol\theta}$</span> is the parameter <span>$\boldsymbol\theta$</span> that maximises the likelihood function, <span>$\hat{\boldsymbol{\theta}} = argmax_{\boldsymbol{\theta} \in \Theta} \mathcal{L}(\boldsymbol{\theta} \mid \boldsymbol x) = argmax_{\boldsymbol\theta \in \Theta} \ell(\boldsymbol\theta \mid \boldsymbol x)$</span>.</p><p><strong>Definition: Profile likelihood function</strong> (see Pawitan, 2001): Suppose we have some parameters of interest, <span>$\boldsymbol \theta \in \Theta$</span>, and some nuisance parameters, <span>$\boldsymbol \phi \in \Phi$</span>, and some data <span>$\boldsymbol x = (x_1,\ldots,x_n)^{\mathsf T}$</span>, giving some joint likelihood <span>$\mathcal L \colon \Theta \cup \Phi \to [0, \infty)$</span> defined by <span>$\mathcal L(\boldsymbol\theta, \boldsymbol\phi \mid \boldsymbol x)$</span>. We define the <em>profile likelihood</em> <span>$\mathcal L_p \colon \Theta \to [0, \infty)$</span> of <span>$\boldsymbol\theta$</span> by <span>$\mathcal L_p(\boldsymbol\theta \mid \boldsymbol x) = \sup_{\boldsymbol \phi \in \Phi \mid \boldsymbol \theta} \mathcal L(\boldsymbol \theta, \boldsymbol \phi \mid \boldsymbol x)$</span>. The <em>profile log-likelihood</em> <span>$\ell_p \colon \Theta \to \mathbb R$</span> of <span>$\boldsymbol\theta$</span> is defined by <span>$\ell_p(\boldsymbol \theta \mid \boldsymbol x) = \log \mathcal L_p(\boldsymbol\theta \mid \boldsymbol x)$</span>. The <em>normalised profile likelihood</em> is defined by <span>$\hat{\mathcal L}_p(\boldsymbol\theta \mid \boldsymbol x) = \mathcal L_p(\boldsymbol \theta \mid \boldsymbol x) - \mathcal L_p(\hat{\boldsymbol\theta} \mid \boldsymbol x)$</span>, where <span>$\hat{\boldsymbol\theta}$</span> is the MLE of <span>$\boldsymbol\theta$</span>, and similarly for the normalised profile log-likelihood.</p><p>From Wilk&#39;s theorem, we know that <span>$2\hat{\ell}\_p(\boldsymbol\theta \mid \boldsymbol x) \geq -\chi_{p, 1-\alpha}^2$</span> is an approximate <span>$100(1-\alpha)\%$</span> confidence region for <span>$\boldsymbol \theta$</span>, and this enables us to obtain confidence intervals for parameters by considering only their profile likelihood, where <span>$\chi_{p,1-\alpha}^2$</span> is the <span>$1-\alpha$</span> quantile of the <span>$\chi_p^2$</span> distribution and <span>$p$</span> is the length of <span>$\boldsymbol\theta$</span>. For the case of a scalar parameter of interest, <span>$-\chi_{1, 0.95}^2/2 \approx -1.92$</span>, and for a bivariate parameter of interest we have <span>$-\chi_{2,0.95}^2/2 \approx -3$</span>.</p><p>We compute the profile log-likelihood in this package by starting at the MLE, and stepping left/right until we reach a given threshold. The code is iterative to not waste time in so much of the parameter space. In the bivariate case, we start at the MLE and expand outwards in layers. This implementation is described in the documentation.</p><p>More detail about the methods we use in this package is given in the sections in the sidebar, with extra detail in the tests. All of the examples in the sidebar use a Gaussian likelihood, but of course the tools here work for any likelihood problem (e.g. some good examples that might be good to show are the Poisson problems <a href="https://www.slac.stanford.edu/econf/C030908/papers/THAT001.pdf">here</a>).</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="interface/">Interface »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 4 August 2023 02:48">Friday 4 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
